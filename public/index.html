<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hypersign KYC Verifier App</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
</head>

<body>
    <div id="alert" style="width: 300px;float: right;">
    </div>
    <div style="display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        height: 200px;
        width:100%
    ">
        <button type="button" class="btn btn-primary btn-lg" id="load2">
            <i class="bi bi-person-bounding-box"></i> Verify Your KYC
        </button>
    </div>
    <div
        style="display: flex; justify-content: center;align-items: center;text-align: center;height: 100%; width: 100%;">
        <div id="userData" style="width: 50%;
        min-height: 70px;
        height: 100%;
        text-align: left;
        word-wrap: break-word;
        border: 1px solid #8080804a;
        padding: 5px;
        border-radius: 10px;
        background: whitesmoke;">
        </div>

    </div>

    <script>
        window.addEventListener('message', function (event) {
            if (event.origin === 'http://localhost:4999') {
                const data = JSON.parse(event.data)
                // Handle the message data sent from the popup
                console.log('Received message from popup:', event.data);

                const alertDiv = document.getElementById('alert')
                if (data.status === 'success') {
                    alertDiv.innerHTML = `
                    <div class="alert alert-primary" role="alert">
                        Successfully verified the user!
                    </div>`
                    const userDataDiv = document.getElementById('userData')
                    userDataDiv.innerText = 'idToken = ' + data.idToken
                }
                else if (data.status === 'fail') {
                    alertDiv.innerHTML = `
                    <div class="alert alert-primary" role="alert">
                        Failed to verify the user, please try again!
                    </div>
                    `
                }
                const button = document.getElementById('load2')
                button.innerHTML = `
                <i class="bi bi-check"></i>You are verified!
                `
                button.attributes('disabled', true)
            }
        });
        $('.btn').on('click', function () {
            var $this = $(this);
            $this.button('loading');
            const button = document.getElementById('load2')
            button.innerHTML = `
                <span class="spinner-grow spinner-grow-sm"></span> Verifiying User...
            `
            const url = 'http://localhost:4999?cavachAccessToken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6ImIzZjA1MDk3ZTI4YWZlODM2MDRlY2ZmZGM3N2UxNTBhYWFlOCIsInVzZXJJZCI6ImMyMjM4NDlmLTYyMTUtNGQ1OS1hZmI0LWFjYTYxODAyZDUxNyIsImdyYW50VHlwZSI6ImFjY2Vzc19zZXJ2aWNlX2t5YyIsImttc0lkIjoiaHM6ZG9jOmItZXlnenluZjNkdmd4NGR2d2ttMWIzamE1M19kd2Nxd2lrYjN4eWU3MzQiLCJ3aGl0ZWxpc3RlZENvcnMiOlsiKiJdLCJzdWJkb21haW4iOiJlbnQtYjNhYmM5MiIsImVkdklkIjoiaHM6ZGV2ZWxvcGVyLWRhc2hib2FyZDphcHA6YjNmMDUwOTdlMjhhZmU4MzYwNGVjZmZkYzc3ZTE1MGFhYWU4IiwiaWF0IjoxNzEwMjI3ODQwLCJleHAiOjE5MTAyNDIyNDB9.9kRYHjQOLJei9b9-07GaHNC_e8sxi-jne5HhUqhBYME&ssiAccessToken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6ImVkYTM4MjM4MjYxOTFiMmU5YmEzNDRhY2JjNTQ4ZGE1ZjRlMCIsInVzZXJJZCI6ImMyMjM4NDlmLTYyMTUtNGQ1OS1hZmI0LWFjYTYxODAyZDUxNyIsImdyYW50VHlwZSI6ImFjY2Vzc19zZXJ2aWNlX3NzaSIsImttc0lkIjoiaHM6ZG9jOnZycWN5amZodWV1anNqZGs3cF8wNDhrbHNtNHAtYzF1d25wdWhfdmlkbDgiLCJ3aGl0ZWxpc3RlZENvcnMiOlsiKiJdLCJzdWJkb21haW4iOiJlbnQtMGJjZTU1YSIsImVkdklkIjoiaHM6ZGV2ZWxvcGVyLWRhc2hib2FyZDphcHA6ZWRhMzgyMzgyNjE5MWIyZTliYTM0NGFjYmM1NDhkYTVmNGUwIiwiaWF0IjoxNzEwMjI3ODY2LCJleHAiOjE5MTAyNDIyNjZ9.OkC1zM4sKDEQ-oaUIAKdBga8_Lk1a2RGDYD4O3jeQwA&pr=eyJxdWVyeSI6W3sidHlwZSI6IlF1ZXJ5QnlFeGFtcGxlIiwiY3JlZGVudGlhbFF1ZXJ5IjpbeyJleGFtcGxlIjp7InR5cGUiOiJQZXJzb25ob29kQ3JlZGVudGlhbCIsImNyZWRlbnRpYWxTY2hlbWEiOnsiaWQiOiJzY2g6aGlkOnRlc3RuZXQ6ejZNa3Z0ZDczZERnZzdIVTh3TENtWGJlMlJBSFBBVTFFeDFWVVhDRnRQVjd1MzZpOjEuMCJ9fSwidHJ1c3RlZElzc3VlciI6W3sicmVxdWlyZWQiOnRydWUsImlzc3VlciI6ImRpZDpoaWQ6dGVzdG5ldDp6Q3lBejJ3ZktqQWFXRTRGVzc1S3hwWmgyd3VvOWtSQVVaeVYyeEVlOTNjS3IifV19XX0seyJ0eXBlIjoiUXVlcnlCeUV4YW1wbGUiLCJjcmVkZW50aWFsUXVlcnkiOlt7ImV4YW1wbGUiOnsidHlwZSI6IlBhc3Nwb3J0Q3JlZGVudGlhbCIsImNyZWRlbnRpYWxTY2hlbWEiOnsiaWQiOiJzY2g6aGlkOnRlc3RuZXQ6ejZNa2dNWFhRTDdZRDdCdWZOTGJqcnd1ZW9qNG5taWg5eHVqSjZhb3pKRG16Rld4OjEuMCJ9fSwidHJ1c3RlZElzc3VlciI6W3sicmVxdWlyZWQiOnRydWUsImlzc3VlciI6ImRpZDpoaWQ6dGVzdG5ldDp6Q3lBejJ3ZktqQWFXRTRGVzc1S3hwWmgyd3VvOWtSQVVaeVYyeEVlOTNjS3IifV19XX1dLCJyZWFzb24iOiJDb21kZXggbmVlZCB5b3VyIHRoZXNlIGluZm9ybWF0aW9uIHRvIGFsbG93IHlvdSBhY2Nlc3MiLCJpc3N1ZXJESUQiOiJkaWQ6aGlkOnRlc3RuZXQ6M2QxMWU0MGYtMjI1MC00ODQ2LWJkMjMtYmZiNThjZjRlZWE1IiwiaXNzdWVyRElEVmVyaWZpY2F0aW9uTWV0aG9kIjoiZGlkOmhpZDp0ZXN0bmV0OjNkMTFlNDBmLTIyNTAtNDg0Ni1iZDIzLWJmYjU4Y2Y0ZWVhNSNrZXktMSIsImRvbWFpbiI6Imh0dHA6Ly9sb2NhbGhvc3Q6NjAwNiIsImxvZ29VcmwiOiJodHRwczovL2VuY3J5cHRlZC10Ym4wLmdzdGF0aWMuY29tL2ltYWdlcz9xPXRibjpBTmQ5R2NRTXNKX3BtLXVQZG1fTXlOeVJOcEI5UlhsbnAzZjlGczFHUFEmdXNxcD1DQVUifQ==&redirectUrl=https://google.com'
            var popup = window.open(url, 'Popup Window', 'width=850,height=860');
        });

        // function getKYcAccesToken () {
        //     return
        // }
    </script>
</body>

</html>